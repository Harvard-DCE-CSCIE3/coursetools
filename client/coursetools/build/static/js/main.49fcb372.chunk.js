(this.webpackJsonpcoursetools=this.webpackJsonpcoursetools||[]).push([[0],{1003:function(e,t){},1004:function(e,t){},1388:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},1389:function(e,t,a){},1435:function(e,t){},1474:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(35),o=a.n(r),l=(a(667),a(31)),i=a(37),c=a(42),u=a(41),d=(n.Component,a(38)),m=a(34),h=a.n(m),p=a(64),f=a(103),v=a.n(f),b=a(649),g=a(240),E=a(130);a(478),a(479);function k(e){return s.a.createElement("div",{className:"grid_actions"},s.a.createElement("a",{href:"https://"+e.canvasHost+"/courses/"+e.value,target:"_blank"},e.value),s.a.createElement("div",{className:"courselink-cog"},s.a.createElement(E.b,{to:"/course/"+e.value,target:"_blank"},s.a.createElement(g.a,null))))}var w=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).onGridReady=function(e){console.log("on grid ready"),n.gridApi=e.api,n.gridColumnApi=e.columnApi,n.gridApi.sizeColumnsToFit()},console.log("Table props"),console.log(e),n.state={columnDefs:[{headerName:"ID",field:"id",resizable:!0,maxWidth:120,sortable:!0,filter:!0,checkboxSelection:!0,cellRenderer:"courseLinkRenderer",cellRendererParams:{canvasHost:e.canvasHost}},{headerName:"Name",field:"name",resizable:!0,sortable:!0,filter:!0,floatingFilter:!0,filterParams:{filterOptions:["contains","notContains"],debounceMs:0,suppressAndOrCondition:!0}},{headerName:"Term",field:"term",maxWidth:100,resizable:!0,sortable:!0,filter:!0,floatingFilter:!0,filterParams:{filterOptions:["contains","notContains"],debounceMs:0,suppressAndOrCondition:!0}},{headerName:"Account",field:"account_name",maxWidth:200,resizable:!0,sortable:!0,filter:!0,floatingFilter:!0,filterParams:{filterOptions:["contains","notContains"],debounceMs:0,suppressAndOrCondition:!0}},{headerName:"State",field:"workflow_state",maxWidth:100,resizable:!0,sortable:!0,filter:!0,floatingFilter:!0,filterParams:{filterOptions:["contains","notContains"],debounceMs:0,suppressAndOrCondition:!0}},{headerName:"Students",field:"total_students",resizable:!0,sortable:!0,filter:!0,maxWidth:100},{headerName:"Start At",field:"start_at",resizable:!0,sortable:!0,filter:"agDateColumnFilter"}],rowData:e.modules,gridOptions:{defaultColDef:{resizable:!0},rowSelection:"multiple",frameworkComponents:{courseLinkRenderer:k}},passSelectionToParent:e.onSelectionChanged},n}return Object(i.a)(a,[{key:"onSelectionChanged",value:function(){var e=this.gridApi.getSelectedRows();this.state.passSelectionToParent(e)}},{key:"componentDidMount",value:function(){console.log("table did mount"),console.log(this.props.courses),this.setState({rowData:this.props.courses})}},{key:"componentDidUpdate",value:function(e){1==this.props.loading?this.gridApi&&this.gridApi.showLoadingOverlay():this.gridApi&&this.gridApi.hideOverlay(),this.state.columnDefs[0].cellRendererParams.canvasHost=e.canvasHost}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"ag-theme-balham",style:{height:"700px",width:"100%"}},s.a.createElement(b.AgGridReact,{columnDefs:this.state.columnDefs,rowData:this.props.courses,gridOptions:this.state.gridOptions,onGridReady:function(t){e.gridApi=t.api,e.gridApi.sizeColumnsToFit()},onSelectionChanged:this.onSelectionChanged.bind(this)}))}}]),a}(n.Component),y=a(54),C=a(1485),S=a(1486),O=a(652),_=a(1495),x=a(1487),j=a(654),A=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={available:""},n.handleEdit=n.handleEdit.bind(Object(d.a)(n)),n.handleStopEdit=n.handleStopEdit.bind(Object(d.a)(n)),console.log(e.course),n}return Object(i.a)(a,[{key:"handleEdit",value:function(e){this.setState({editMode:!0})}},{key:"handleStopEdit",value:function(e){this.setState({editMode:!1})}},{key:"workflowState",value:function(){var e={workflow_state:"",start_at:"",end_at:""},t=this.props.course,a=t.workflow_state,n=t.start_at,s=t.end_at;return a&&(a="available"==a?"Published":a.charAt(0).toUpperCase()+a.slice(1)),e.workflow_state=a,n&&(e.start_at=new Date(n)),s&&(e.end_at=new Date(s)),e}},{key:"moduleState",value:function(){var e=this.props.course.modules.length;return{modules:e,hasMods:e>0,modules_published:this.props.course.modules.reduce((function(e,t){return t.published?++e:e}),0)}}},{key:"render",value:function(){return s.a.createElement(C.a,null,s.a.createElement(S.a,null,s.a.createElement(O.a,null,s.a.createElement("h2",null,this.props.course.name))),s.a.createElement(S.a,null,s.a.createElement(O.a,null,s.a.createElement(_.a,null,s.a.createElement(_.a.Body,null,s.a.createElement(_.a.Header,null,"Course Info"),s.a.createElement(x.a,null,s.a.createElement(j.a,null,s.a.createElement("b",null,"Course ID: "),this.props.number),s.a.createElement(j.a,null,s.a.createElement("b",null,"Course Code: ")," ",this.props.course.course_code),s.a.createElement(j.a,null,s.a.createElement("b",null,"Account: ")," ",this.props.course.account.name," "),s.a.createElement(j.a,null,s.a.createElement("b",null,"Term: ")," ",this.props.course.term.name,this.props.course.term.start_at?s.a.createElement("div",null,s.a.createElement("br",null),s.a.createElement("b",null,"Term Dates: ")," ",this.props.course.term.start_at," until ",this.props.course.term.end_at):"")),s.a.createElement(_.a.Header,null,"Enrollment Info"),s.a.createElement(x.a,null,s.a.createElement(j.a,null,s.a.createElement("b",null,"Students "),this.props.course.students.length),s.a.createElement(j.a,null,s.a.createElement("b",null,"Sections: ")," ",this.props.course.sections.length),s.a.createElement(j.a,null,s.a.createElement("b",null,"Teachers: ")," ",this.props.course.teachers.length," "))))),s.a.createElement(O.a,null,s.a.createElement(_.a,null,s.a.createElement(_.a.Body,null,s.a.createElement(_.a.Header,null,"Visibility"),s.a.createElement(x.a,null,s.a.createElement(j.a,null,s.a.createElement("b",null,"Availability: ")," ",this.workflowState().workflow_state),s.a.createElement(j.a,null,s.a.createElement("b",null,"Is Public: ")," ",this.props.course.is_public?"Yes":"No"),s.a.createElement(j.a,null,s.a.createElement("b",null,"Opens On: ")," ",this.workflowState().start_at.toString()),s.a.createElement(j.a,null,s.a.createElement("b",null,"Closes On: ")," ",this.workflowState().end_at.toString())),s.a.createElement(_.a.Header,null,"Configuration"),s.a.createElement(x.a,null,s.a.createElement(j.a,null,s.a.createElement("b",null,"Default View: ")," ",this.props.course.default_view),s.a.createElement(j.a,null,s.a.createElement("b",null,"Modules: ")," ",this.moduleState().modules),s.a.createElement(j.a,null,s.a.createElement("b",null,"Published Modules: ")," ",this.moduleState().modules_published)))))))}}]),a}(n.Component),D=a(176),I=a(90),N=a.n(I),T=a(77),M=a(70),R=a(1488),G=a(1489),F=a(1493),P=a(1491),H=a(655),z=a.n(H),L=new(a(363).JSDOM)("").window,U=z()(L),B=v()(),W=B.api,q=(B.getStatus,function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var s=(e.item.html_url||e.item.items_url).match(/courses\/(\d+)\//)[1];return n.state={content:{},courseId:s,type:e.item.type||""},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.getContent().then((function(t){e.setState({content:t})}))}},{key:"getContent",value:function(){var e=Object(p.a)(h.a.mark((function e(){var t,a,n,s,r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Discussion"==(t=this.props.item.type)&&console.log(this.props.item),"Page"!=t){e.next=9;break}return e.next=5,W.course.page.get({courseId:this.state.courseId,pageURL:this.props.item.page_url});case 5:return a=e.sent,e.abrupt("return",a);case 9:if("Assignment"!=t){e.next=16;break}return e.next=12,W.course.assignment.get({courseId:this.state.courseId,assignmentId:this.props.item.content_id});case 12:return n=e.sent,e.abrupt("return",n);case 16:if("Discussion"!=t){e.next=26;break}return console.log("getting /api/v1/courses/".concat(this.state.courseId,"/discussion_topics/").concat(this.props.item.content_id)),e.next=20,W.other.endpoint({path:"/api/v1/courses/".concat(this.state.courseId,"/discussion_topics/").concat(this.props.item.content_id),method:"GET"});case 20:return s=e.sent,console.log(s),s.description=s.message,e.abrupt("return",s.assignment||s);case 26:if("Quiz"!=t){e.next=33;break}return e.next=29,W.course.quiz.get({courseId:this.state.courseId,quizId:this.props.item.content_id});case 29:return r=e.sent,e.abrupt("return",r);case 33:if("File"!=t){e.next=38;break}return e.next=36,W.other.endpoint({path:"/api/v1/courses/".concat(this.state.courseId,"/modules/").concat(this.props.item.module_id,"/items/").concat(this.props.item.id),method:"GET"});case 36:return o=e.sent,e.abrupt("return",o);case 38:return e.abrupt("return");case 39:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"popover",value:function(){return s.a.createElement(F.a,{id:"popover-basic"},s.a.createElement(F.a.Title,{as:"h3"},"Page Content"),s.a.createElement(F.a.Content,null,this.state.content.body))}},{key:"loadPreview",value:function(e){return e.preventDefault(),!1}},{key:"render",value:function(){return s.a.createElement(P.a,{delay:{show:50,hide:200},placement:"right",trigger:"click",rootClose:!0,overlay:s.a.createElement(F.a,{id:"popover-basic"},s.a.createElement(F.a.Title,{as:"h3"},(this.state.type||"")+": "+(this.state.content&&(this.state.content.title||this.state.content.name||""))),s.a.createElement(F.a.Content,null,("Assignment"==this.state.type||"Quiz"==this.state.type||"Discussion"==this.state.type)&&s.a.createElement("div",{className:"assn_dates_popover"},s.a.createElement("b",null,"Due At:"),this.state.content&&(this.state.content.due_at||"")," ",s.a.createElement("b",null,"Unlock At: "),this.state.content&&(this.state.content.unlock_at||"")," ",s.a.createElement("b",null,"Available Until: "),this.state.content&&(this.state.content.lock_at||"")),s.a.createElement("div",{className:"preview_content",dangerouslySetInnerHTML:{__html:U.sanitize(this.state.content&&(this.state.content.body||this.state.content.description||"N/A"),{ADD_TAGS:["iframe"]})}})))},s.a.createElement("a",{href:"#",onClick:this.loadPreview,title:"Preview Content",className:"previewIcon"},s.a.createElement(T.a,{icon:M.c})))}}]),a}(n.Component)),J=a(656),V=a.n(J),Y=a(376),Q=a.n(Y),K=a(370),$=a(369),X=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={row:e.row,value:e.value,focused:!0,date:null,handleDateChange:e.handleDateChange},n.handleDateChange=n.handleDateChange.bind(Object(d.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.state.row&&this.state.row[this.props.col]&&this.setState({date:Q()(this.state.row[this.props.col]).toDate()})}},{key:"handleDateChange",value:function(e){this.state.row[this.props.col]=e&&e.toISOString()||"",console.log("updated date: "+this.state.row[this.props.col]),this.state.row.handleDateChange(e,this.props.col,this.state.row),this.setState({date:e})}},{key:"componentWillReceiveProps",value:function(e){e.row&&e.row[this.props.col]?this.setState({date:Q()(e.row[this.props.col]).toDate(),row:e.row}):this.setState({date:null,row:e.row})}},{key:"render",value:function(){var e=this,t=this.state.row&&this.state.row.type,a=this.state.row&&this.state.row.id||null;return"Module"==t&&"due_at"==this.props.col?s.a.createElement("span",null):"Module"==t||"Assignment"==t||"Quiz"==t||"Discussion"==t?s.a.createElement(V.a,{id:this.props.col+a,selected:this.state.date,onChange:function(t){return e.handleDateChange(t)},portalId:"root-portal",monthsShown:1,showTimeSelect:!0,className:this.state.row.modified&&this.state.row.modified.includes(this.props.col)?"edited_cell":"",timeFormat:"HH:mm",timeIntervals:60,shouldCloseOnSelect:!0,injectTimes:[Object(K.default)(Object($.default)(new Date,59),23)],dateFormat:"MM/dd/yyyy h:mm aa",popperModifiers:{offset:{enabled:!0,offset:"5px, 10px"},preventOverflow:{enabled:!0,escapeWithReference:!1,boundariesElement:"viewport"}}}):s.a.createElement("span",null)}}]),a}(n.Component),Z=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return s.a.createElement(X,Object.assign({},this.props,{col:"unlock_at"}))}}]),a}(s.a.Component),ee=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return s.a.createElement(X,Object.assign({},this.props,{col:"due_at"}))}}]),a}(s.a.Component),te=v()(),ae=te.api;te.getStatus;function ne(e){return e.due_at&&(e.dueAt=e.due_at),e.unlock_at&&(e.unlockAt=e.unlock_at),e.lock_at&&(e.lockAt=e.lock_at),e}var se=function e(){Object(l.a)(this,e)};se.updateItem=function(){var e=Object(p.a)(h.a.mark((function e(t,a,n,s){var r,o,l,i,c,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("type is "+t),console.log("content_id is "+n),r={},e.t0=t,e.next="Assignment"===e.t0?6:"Module"===e.t0?12:"Quiz"===e.t0?19:"Discussion"===e.t0?25:"Page"===e.t0?31:"ExternalUrl"===e.t0||"SubHeader"===e.t0||"ExternalTool"===e.t0||"File"===e.t0?41:46;break;case 6:return s=ne(s),r=Object.assign({assignmentId:n},s),e.next=10,ae.course.assignment.update(r);case 10:return e.abrupt("return",e.sent);case 12:for(l in o={},s)o["module["+l+"]"]=s[l];return r={method:"PUT",path:"/api/v1/courses/".concat(s.courseId,"/modules/").concat(a),params:o},e.next=17,ae.other.endpoint(r);case 17:return e.abrupt("return",e.sent);case 19:return s=ne(s),r=Object.assign({quizId:n},s),e.next=23,ae.course.quiz.update(r);case 23:return e.abrupt("return",e.sent);case 25:return s=ne(s),r={method:"PUT",path:"/api/v1/courses/".concat(s.courseId,"/discussion_topics/").concat(n),params:s},e.next=29,ae.other.endpoint(r);case 29:return e.abrupt("return",e.sent);case 31:for(u in i=n.match(/.*\/(\S+)/),console.log("url"),console.log(i[1]),c={},s)c["wiki_page["+u+"]"]=s[u];return r={method:"PUT",path:"/api/v1/courses/".concat(s.courseId,"/pages/").concat(i[1]),params:c},e.next=39,ae.other.endpoint(r);case 39:return e.abrupt("return",e.sent);case 41:return r={method:"PUT",path:"/api/v1/courses/".concat(s.courseId,"/modules/").concat(s.module_id,"/items/").concat(a),params:{"module_item[title]":s.name}},e.next=44,ae.other.endpoint(r);case 44:return e.abrupt("return",e.sent);case 46:case"end":return e.stop()}}),e)})));return function(t,a,n,s){return e.apply(this,arguments)}}(),se.responses=[],se.updateModules=function(){var e=Object(p.a)(h.a.mark((function e(t,a){var n,s,r,o,l=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.responses=[],n={courseId:t},s=0;case 3:if(!(s<a.length)){e.next=25;break}if(!(a[s].modified.length>0)){e.next=22;break}for(console.log("updating a row"),console.log(a[s]),r=a[s].modified,o=0;o<a[s].modified.length;o++)"unlock_at"==r[o]||"lock_at"==r[o]||"due_at"==r[o]?n[r[o]]=a[s][r[o]]||"":n[r[o]]=a[s][r[o]];return n.name=a[s].name,n.title=a[s].name,n.module_id=a[s].module_id,e.prev=12,console.log("calling updateItem on "+a[s].type+" with content_id "+a[s].content_id+"params "),console.log(n),e.next=17,this.updateItem(a[s].type,a[s].id,a[s].content_id||a[s].url||a[s].discussion_topic&&a[s].discussion_topic.id||null,n).then((function(e){return l.responses.push(e)}));case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(12),console.log("failed in APIService.updateModules"+e.t0);case 22:s++,e.next=3;break;case 25:case"end":return e.stop()}}),e,this,[[12,19]])})));return function(t,a){return e.apply(this,arguments)}}();var re=se,oe=[{key:"position",name:"Actions",width:75,resizeable:!1,formatter:function(e){var t=e.row,a=e.row.url||"";if("ExternalTool"==t.type)return s.a.createElement("span",null);if(t.external_url)return s.a.createElement("span",null,s.a.createElement("a",{href:t.external_url,target:"_blank",title:"Open in Canvas (opens in a new window)"},s.a.createElement(T.a,{className:"externalLinkIcon",icon:M.b})));var n=a.match(/([\s\S]*?)\/api\/v1([\s\S]*)/);if(n&&n.length>0)return s.a.createElement("span",null,s.a.createElement("a",{href:n[1]+n[2],target:"_blank",title:"Open in Canvas (opens in a new window)"},s.a.createElement(T.a,{className:"externalLinkIcon",icon:M.b})),s.a.createElement(q,{item:t}));return s.a.createElement("span",null)}},{key:"name",name:"Name (double-click to edit)",width:400,resizeable:!0,editable:!0,formatter:function(e){for(var t=e.row,a=0;t.modified&&a<t.modified.length;a++){var n=t.modified[a];if(t[n]==e.value)return s.a.createElement("span",{className:"edited_cell indent-"+t.indent},e.value)}return s.a.createElement("span",{className:"indent-"+t.indent},e.value)}},{key:"published",name:"Published",width:100,formatter:function(e){var t=e.row;if(t.modified&&t.modified.includes("published"))return s.a.createElement("span",{className:"edited_cell"},e.value?"Yes":"No");return s.a.createElement("span",null,e.value?"Yes":"No"," ")},resizeable:!0},{key:"type",name:"Type",width:110,resizeable:!0},{key:"unlock_at",name:"Unlock At",resizeable:!0,formatter:Z},{key:"due_at",name:"Due At",resizeable:!0,formatter:ee}];function le(e){return"Module"==e.row.type?s.a.createElement("div",{className:"module_row"},s.a.createElement(I.Row,e)):s.a.createElement(I.Row,e)}var ie=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).onGridRowsUpdated=function(e){var t=e.fromRow,a=e.toRow,s=e.updated,r=(e.cellKey,e.fromRowData);n.setState({modified:!0}),n.setState((function(e){for(var n=e.data.slice(),o=t;o<=a;o++)for(var l in n[o]=Object(D.a)(Object(D.a)({},n[o]),s),s)s[l]!=r[l]&&-1==n[o].modified.indexOf(l)&&(n[o].modified.push(l),console.log("pushing modified: "+l+" to "+n[o].modified));return{data:n}}))},n.state={data:[],modified:!1,refresh:!1,showSaveResults:!1,responses:[]},n.dateHandler=n.dateHandler.bind(Object(d.a)(n)),n.saveToCanvas=n.saveToCanvas.bind(Object(d.a)(n)),n.clearModifiedFlags=n.clearModifiedFlags.bind(Object(d.a)(n)),n.getCellActions=n.getCellActions.bind(Object(d.a)(n)),n.clearAllDates=n.clearAllDates.bind(Object(d.a)(n)),n.bulkPublish=n.bulkPublish.bind(Object(d.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){console.log("table did mount"),console.log(this.props.course);var e=this.props.course.modules||[];this.setState({data:this.flattenModuleData(e)})}},{key:"componentWillReceiveProps",value:function(e){console.log("table getting props");var t=e.course.modules||[];this.setState({data:this.flattenModuleData(t)})}},{key:"flattenModuleData",value:function(e){console.log("flattening");for(var t=[],a=0;e&&a<e.length;a++){var n=e[a];n.type="Module",n.modified=[],t.push(n);for(var s=0;n.items&&s<n.items.length;s++){var r=n.items[s];for(var o in r.name=r.title,r.modified=[],r.content_details)r[o]=r.content_details[o];t.push(r)}}return console.log("flattened"),console.log(t),t=this.addDateHandlerToRow(t)}},{key:"dateHandler",value:function(e,t,a){console.log("cjhanging date");for(var n=this.state.data,s=0;s<n.length;s++)if(n[s].id==a.id)return n[s][t]=e&&e.toISOString()||null,n[s].modified.push(t),console.log("changed "+t+" to "+n[s][t]),void this.setState({data:n,modified:!0})}},{key:"clearModifiedFlags",value:function(e){return e.map((function(e){return e.modified=[],e}))}},{key:"addDateHandlerToRow",value:function(e){var t=this;return e.map((function(e){return e.handleDateChange=t.dateHandler,e}))}},{key:"getRowCount",value:function(){var e=this.state.data.length;return console.log("count is "+e),this.state.refresh&&e>0&&(e--,this.setState({refresh:!1})),e}},{key:"refresh",value:function(){this.setState({refresh:!0})}},{key:"saveToCanvas",value:function(){var e=Object(p.a)(h.a.mark((function e(){var t=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("sAVING"),re.updateModules(this.props.course.id,this.state.data).then((function(e){console.log("clearing flags"),t.setState({data:t.clearModifiedFlags(t.state.data)}),console.log("saved response"),console.log(re.responses),t.setState({showSaveResults:!0,responses:re.responses,modified:!1}),t.refresh(),console.log("refreshed")}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCellActions",value:function(e,t){var a=this;return{published:[{icon:s.a.createElement("span",null,s.a.createElement(T.a,{className:"externalLinkIcon",icon:M.d})),callback:function(){for(var e=a.state.data,n=0;n<e.length;n++)if(e[n].id==t.id)return console.log("found the row, was "+e[n].published),e[n].published=1!=e[n].published,console.log("now is "+e[n].published),e[n].modified.push("published"),a.setState({data:e,modified:!0}),void a.refresh()}}]}[e.key]}},{key:"clearAllDates",value:function(){var e=this.state.data;console.log(e);var t=e.map((function(e){return""!=e.unlock_at&&(e.unlock_at="",e.modified.push("unlock_at")),""!=e.due_at&&(e.due_at="",e.modified.push("due_at")),e}));console.log(t),this.setState({data:t}),this.refresh()}},{key:"bulkPublish",value:function(e){var t=this.state.data.map((function(t){return t.published!=e&&(t.modified.push("published"),t.published=e),t}));console.log(t),this.setState({data:t,modified:!0}),this.refresh()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(C.a,null,s.a.createElement(S.a,null,s.a.createElement(O.a,null,s.a.createElement("h3",null,"Modules")),s.a.createElement(O.a,{xs:6},s.a.createElement(R.a,{className:"bulk-actions-button",variant:"primary",onClick:this.clearAllDates},"Clear All Dates"),s.a.createElement(R.a,{className:"bulk-actions-button",variant:"primary",onClick:function(){return e.bulkPublish(!1)}},"Unpublish All"),s.a.createElement(R.a,{className:"bulk-actions-button",variant:"primary",onClick:function(){return e.bulkPublish(!0)}},"Publish All")),s.a.createElement(O.a,null,this.state.modified&&s.a.createElement("div",null,s.a.createElement(R.a,{variant:"primary",className:"float-top",onClick:this.saveToCanvas},"Save Changes")," "))),s.a.createElement(S.a,null,s.a.createElement(O.a,null,s.a.createElement(N.a,{columns:oe,rowGetter:function(t){return e.state.data[t]},rowsCount:this.getRowCount(),rowRenderer:le,minHeight:36*this.state.data.length+40,enableCellSelect:!0,onGridRowsUpdated:this.onGridRowsUpdated,getCellActions:this.getCellActions})))),s.a.createElement(G.a,{show:this.state.showSaveResults,onHide:function(){e.setState({showSaveResults:!1,responses:[]})}},s.a.createElement(G.a.Header,{closeButton:!0},s.a.createElement(G.a.Title,null,"Canvas Data Saved")),s.a.createElement(G.a.Body,null,this.state.responses.length," records were updated in Canvas"),s.a.createElement(G.a.Footer,null,s.a.createElement(R.a,{variant:"secondary",onClick:function(){e.setState({showSaveResults:!1,responses:[]})}},"Close"))))}}]),a}(n.Component),ce=[{key:"position",name:"Actions",width:75,resizeable:!1,formatter:function(e){console.log(e);var t=e.row;t.content_id=t.discussion_topic&&t.discussion_topic.id||t.id;var a=e.row.html_url||"";if("ExternalTool"==t.type)return s.a.createElement("span",null);if(t.external_url)return s.a.createElement("span",null,s.a.createElement("a",{href:t.external_url,target:"_blank",title:"Open in Canvas (opens in a new window)"},s.a.createElement(T.a,{className:"externalLinkIcon",icon:M.b})));if(a&&a.length>0)return s.a.createElement("span",null,s.a.createElement("a",{href:a,target:"_blank",title:"Open in Canvas (opens in a new window)"},s.a.createElement(T.a,{className:"externalLinkIcon",icon:M.b})),s.a.createElement(q,{item:t}));return s.a.createElement("span",null)}},{key:"name",name:"Name",width:400,resizeable:!0,editable:!0,sortable:!0,formatter:function(e){for(var t=e.row,a=0;t.modified&&a<t.modified.length;a++){var n=t.modified[a];if(t[n]==e.value)return s.a.createElement("span",{className:"edited_cell indent-"+t.indent},e.value)}return s.a.createElement("span",{className:"indent-"+t.indent},e.value)}},{key:"published",name:"Published",width:100,formatter:function(e){var t=e.row;if(t.modified&&t.modified.includes("published"))return s.a.createElement("span",{className:"edited_cell"},e.value?"Yes":"No");return s.a.createElement("span",null,e.value?"Yes":"No"," ")},resizeable:!0},{key:"type",name:"Type",width:110,sortable:!0,resizeable:!0},{key:"unlock_at",name:"Unlock At",resizeable:!0,sortable:!0,formatter:Z},{key:"due_at",name:"Due At",resizeable:!0,sortable:!0,formatter:ee}];function ue(e){return"Module"==e.row.type?s.a.createElement("div",{className:"module_row"},s.a.createElement(I.Row,e)):s.a.createElement(I.Row,e)}var de=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).onGridRowsUpdated=function(e){var t=e.fromRow,a=e.toRow,s=e.updated,r=(e.cellKey,e.fromRowData);n.setState({modified:!0}),n.setState((function(e){for(var n=e.data.slice(),o=t;o<=a;o++)for(var l in n[o]=Object(D.a)(Object(D.a)({},n[o]),s),s)s[l]!=r[l]&&-1==n[o].modified.indexOf(l)&&(n[o].modified.push(l),console.log("pushing modified: "+l+" to "+n[o].modified));return{data:n}}))},n.state={data:[],modified:!1,refresh:!1,showSaveResults:!1,responses:[]},n.dateHandler=n.dateHandler.bind(Object(d.a)(n)),n.saveToCanvas=n.saveToCanvas.bind(Object(d.a)(n)),n.clearModifiedFlags=n.clearModifiedFlags.bind(Object(d.a)(n)),n.getCellActions=n.getCellActions.bind(Object(d.a)(n)),n.clearAllDates=n.clearAllDates.bind(Object(d.a)(n)),n.bulkPublish=n.bulkPublish.bind(Object(d.a)(n)),n.sortRows=n.sortRows.bind(Object(d.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){console.log("table did mount"),console.log(this.props.course);var e=this.props.course.assignments||[],t=this.flattenData(e);this.setState({data:t,originalData:t.slice(0)})}},{key:"componentWillReceiveProps",value:function(e){console.log("table getting props");var t=this.flattenData(e.course.assignments)||[];this.setState({data:t,originalData:t.slice(0)})}},{key:"flattenData",value:function(e){console.log("flattening");for(var t=[],a=0;e&&a<e.length;a++){var n=e[a];n.modified=[],t.push(n)}return console.log("flattened"),console.log(t),t=this.addDateHandlerToRow(t)}},{key:"dateHandler",value:function(e,t,a){console.log("cjhanging date");for(var n=this.state.data,s=0;s<n.length;s++)if(n[s].id==a.id)return n[s][t]=e&&e.toISOString()||null,n[s].modified.push(t),console.log("changed "+t+" to "+n[s][t]),void this.setState({data:n,modified:!0})}},{key:"clearModifiedFlags",value:function(e){return e.map((function(e){return e.modified=[],e}))}},{key:"addDateHandlerToRow",value:function(e){var t=this;return e.map((function(e){return e.handleDateChange=t.dateHandler,e}))}},{key:"sortRows",value:function(e,t){var a="NONE"===t?this.state.originalData.slice(0):this.state.data.sort((function(a,n){var s=a[e],r=n[e];if("date"===e){var o=a[e].split("."),l=(s=new Date(o[2],o[1]-1,o[0]).valueOf(),n[e].split("."));r=new Date(l[2],l[1]-1,l[0]).valueOf()}return"ASC"===t?s>r?1:-1:"DESC"===t?s<r?1:-1:void 0}));this.setState({data:a})}},{key:"getRowCount",value:function(){var e=this.state.data.length;return console.log("count is "+e),this.state.refresh&&e>0&&(e--,this.setState({refresh:!1})),e}},{key:"refresh",value:function(){this.setState({refresh:!0})}},{key:"saveToCanvas",value:function(){var e=Object(p.a)(h.a.mark((function e(){var t=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("sAVING"),re.updateModules(this.props.course.id,this.state.data).then((function(e){console.log("clearing flags"),t.setState({data:t.clearModifiedFlags(t.state.data)}),console.log("saved response"),console.log(re.responses),t.setState({showSaveResults:!0,responses:re.responses,modified:!1}),t.refresh(),console.log("refreshed")}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCellActions",value:function(e,t){var a=this;return{published:[{icon:s.a.createElement("span",null,s.a.createElement(T.a,{className:"externalLinkIcon",icon:M.d})),callback:function(){for(var e=a.state.data,n=0;n<e.length;n++)if(e[n].id==t.id)return console.log("found the row, was "+e[n].published),e[n].published=1!=e[n].published,console.log("now is "+e[n].published),e[n].modified.push("published"),a.setState({data:e,modified:!0}),void a.refresh()}}]}[e.key]}},{key:"clearAllDates",value:function(){var e=this.state.data;console.log(e);var t=e.map((function(e){return""!=e.unlock_at&&(e.unlock_at="",e.modified.push("unlock_at")),""!=e.due_at&&(e.due_at="",e.modified.push("due_at")),e}));console.log(t),this.setState({data:t}),this.refresh()}},{key:"bulkPublish",value:function(e){var t=this.state.data.map((function(t){return t.published!=e&&(t.modified.push("published"),t.published=e),t}));console.log(t),this.setState({data:t,modified:!0}),this.refresh()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(C.a,null,s.a.createElement(S.a,null,s.a.createElement(O.a,null,s.a.createElement("h3",null,"Modules")),s.a.createElement(O.a,{xs:6},s.a.createElement(R.a,{className:"bulk-actions-button",variant:"primary",onClick:this.clearAllDates},"Clear All Dates"),s.a.createElement(R.a,{className:"bulk-actions-button",variant:"primary",onClick:function(){return e.bulkPublish(!1)}},"Unpublish All"),s.a.createElement(R.a,{className:"bulk-actions-button",variant:"primary",onClick:function(){return e.bulkPublish(!0)}},"Publish All")),s.a.createElement(O.a,null,this.state.modified&&s.a.createElement("div",null,s.a.createElement(R.a,{variant:"primary",className:"float-top",onClick:this.saveToCanvas},"Save Changes")," "))),s.a.createElement(S.a,null,s.a.createElement(O.a,null,s.a.createElement(N.a,{columns:ce,rowGetter:function(t){return e.state.data[t]},rowsCount:this.getRowCount(),rowRenderer:ue,minHeight:36*this.state.data.length+40,enableCellSelect:!0,onGridRowsUpdated:this.onGridRowsUpdated,getCellActions:this.getCellActions,onGridSort:this.sortRows})))),s.a.createElement(G.a,{show:this.state.showSaveResults,onHide:function(){e.setState({showSaveResults:!1,responses:[]})}},s.a.createElement(G.a.Header,{closeButton:!0},s.a.createElement(G.a.Title,null,"Canvas Data Saved")),s.a.createElement(G.a.Body,null,this.state.responses.length," records were updated in Canvas"),s.a.createElement(G.a.Footer,null,s.a.createElement(R.a,{variant:"secondary",onClick:function(){e.setState({showSaveResults:!1,responses:[]})}},"Close"))))}}]),a}(n.Component),me=a(1492),he=a(1494),pe=v()(),fe=pe.api,ve=(pe.getStatus,function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={course:{account:{},term:{},sections:[],teachers:[],students:[],enrollments:[],modules:[],name:""},courseId:e.match.params.number},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(p.a)(h.a.mark((function e(){var t,a,n,s,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fe.course.get({courseId:this.state.courseId,includeSyllabus:!0,includeTerm:!0,includeAccount:!0,includeDescription:!0,includeSections:!0,includeTeachers:!0,includeCourseImage:!0,includeNeedsGradingCount:!0});case 3:return t=e.sent,console.log(t),e.next=7,fe.other.endpoint({path:"/api/v1/courses/"+this.state.courseId+"/modules",method:"GET",params:{include:["items","content_details"]}});case 7:return a=e.sent,t.modules=a,e.next=11,fe.course.assignment.list({courseId:this.state.courseId});case 11:return n=e.sent,s=n.map((function(e){return e.discussion_topic?e.type="Discussion":e.type="Assignment",e})),t.assignments=s,e.next=16,fe.course.listStudents({courseId:this.state.courseId,includeEnrollments:!0});case 16:r=e.sent,t.students=r,this.setState({course:t}),e.next=24;break;case 21:return e.prev=21,e.t0=e.catch(0),e.abrupt("return",this.setState({message:"Error while retrieving course: ".concat(e.t0.message)}));case 24:case"end":return e.stop()}}),e,this,[[0,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(me.a,{bg:"dark",variant:"dark",expand:"lg"},s.a.createElement(me.a.Brand,null,"CourseTools"),s.a.createElement(me.a.Toggle,{"aria-controls":"basic-navbar-nav"}),s.a.createElement(me.a.Collapse,{id:"basic-navbar-nav"},s.a.createElement(he.a,{className:"mr-auto"},s.a.createElement(he.a.Link,{href:"/coursetools/course/"+this.props.match.params.number+"/info"},"Course Info"),s.a.createElement(he.a.Link,{href:"/coursetools/course/"+this.props.match.params.number+"/modules"},"Course Modules"),s.a.createElement(he.a.Link,{href:"/coursetools/course/"+this.props.match.params.number+"/assignments"},"Course Assignments")),s.a.createElement(me.a.Text,null,s.a.createElement("b",null,"Course Title:")," ",this.state.course.name," ",s.a.createElement("b",null,"Course ID:")," ",this.props.match.params.number))),s.a.createElement(y.c,null,s.a.createElement(y.a,{exact:!0,path:"/course/:number"},s.a.createElement(A,{number:this.props.match.params.number,course:this.state.course})),s.a.createElement(y.a,{exact:!0,path:"/course/:number/info"},s.a.createElement(A,{number:this.props.match.params.number,course:this.state.course})),s.a.createElement(y.a,{exact:!0,path:"/course/:number/modules"},s.a.createElement(ie,{course:this.state.course})),s.a.createElement(y.a,{exact:!0,path:"/course/:number/assignments"},s.a.createElement(de,{course:this.state.course}))))}}]),a}(n.Component)),be=a(1490),ge=function e(){Object(l.a)(this,e)};ge.saveCourseGroup=function(e,t){console.log("setting course group"),console.log(e),localStorage.setItem(t,JSON.stringify(e))},ge.getCourseGroup=function(e){return console.log("getting course group "+e),console.log(localStorage.getItem(e)),JSON.parse(localStorage.getItem(e))};var Ee=ge,ke=(a(1388),a(1389),v()()),we=ke.api;ke.getStatus;var ye=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={message:"Loading! Just a moment...",courses:[],accountid:"",account_name:"",loading:!1,accounts:[{id:"",name:""}],terms:[{id:"",name:""}],keyword:"",termid:"",selected:[],groupId:""},n.handleAccountChange=n.handleAccountChange.bind(Object(d.a)(n)),n.handleTermChange=n.handleTermChange.bind(Object(d.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(d.a)(n)),n.onSelectionChanged=n.onSelectionChanged.bind(Object(d.a)(n)),n.openCourseGroup=n.openCourseGroup.bind(Object(d.a)(n)),n}return Object(i.a)(a,[{key:"handleAccountChange",value:function(e){this.setState({accountid:e.target.value})}},{key:"handleTermChange",value:function(e){this.setState({termid:e.target.value})}},{key:"handleKeywordChange",value:function(e){this.setState({keyword:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(p.a)(h.a.mark((function e(t){var a,n,s,r,o=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.setState({loading:!0}),e.prev=2,a=t.target.account.value,n=t.target.term.value,this.setState({accountid:a,termid:n}),s=this.state.terms,r=[],!a){e.next=14;break}return e.next=11,we.account.listCourses({includeTotalStudents:!0,accountId:a,includeAccountName:!0,includeTerm:!0,enrollmentTermId:n||"",searchTerm:t.target.keyword.value});case 11:r=e.sent,e.next=20;break;case 14:return e.next=16,we.user.self.listCourses({includeTotalStudents:!0,includeAccountName:!0,includeTerm:!0});case 16:return r=e.sent,e.next=19,we.other.endpoint({path:"/api/v1/courses/",method:"GET",params:{include:["term","account","total_students","needs_grading_count"]}});case 19:r=e.sent;case 20:return r.forEach((function(e){e.term=o.lookupTermName(e.enrollment_term_id,s)})),e.abrupt("return",this.setState({courses:r,terms:s,loading:!1}));case 24:return e.prev=24,e.t0=e.catch(2),this.setState({loading:!1}),e.abrupt("return",this.setState({message:"Error while requesting user profile: ".concat(e.t0.message)}));case 28:case"end":return e.stop()}}),e,this,[[2,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"lookupTermName",value:function(e,t){for(var a=0;a<t.length;a++)if(e==t[a].id)return t[a].name}},{key:"componentDidMount",value:function(){var e=Object(p.a)(h.a.mark((function e(){var t,a,n,s,r,o,l,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,we.user.self.getProfile();case 3:return t=e.sent,e.next=6,we.account.list();case 6:return a=e.sent,n=a.map((function(e){return{id:e.id,name:e.name,label:e.name,value:e.id}})),console.log("didMount accounts"),console.log(n),e.next=12,we.account.enrollmentTerm.list({accountId:"1"});case 12:return(s=e.sent).unshift({id:"",name:""}),r=(r=s.map((function(e){return{id:e.id,name:e.name,label:e.name,value:e.id}}))).sort((function(e,t){return"Default Term"==e.name?-1:"Default Term"==t.name?1:e.name<t.name?-1:e.name>t.name?1:0})),e.next=18,fetch("/config",{credentials:"include"});case 18:return o=e.sent,console.log(o),e.next=22,o.json();case 22:return l=e.sent,i=l.canvasHost,console.log("didMount terms"),console.log(i),console.log(r),console.log("output"),console.log(t),e.abrupt("return",this.setState({message:"Hello ".concat(t.name,"!"),accounts:n,terms:r,canvasHost:i}));case 32:return e.prev=32,e.t0=e.catch(0),e.abrupt("return",this.setState({message:"Error while requesting user profile: ".concat(e.t0.message)}));case 35:case"end":return e.stop()}}),e,this,[[0,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"onSelectionChanged",value:function(e){console.log("changed in app course list");var t=Date.now();this.setState({selected:e,groupId:t})}},{key:"openCourseGroup",value:function(e){e.preventDefault();var t=Date.now(),a=this.state.selected;Ee.saveCourseGroup(a,t),e.persist(),this.setState({selected:a,groupId:t},(function(){e.target.dispatchEvent(new MouseEvent("click"))}))}},{key:"render",value:function(){var e=this.state,t=e.message,a=e.courses,n=(e.terms,e.loading),r=e.canvasHost;console.log("state"),console.log(this.state),console.log(r);var o=this.state.accounts.map((function(e){return s.a.createElement("option",{value:e.id},e.name)})),l=this.state.terms.map((function(e){return s.a.createElement("option",{value:e.id},e.name)}));return s.a.createElement("div",null,s.a.createElement(me.a,{bg:"dark",variant:"dark"},s.a.createElement(me.a.Brand,null,"CourseTools"),s.a.createElement(me.a.Toggle,{"aria-controls":"basic-navbar-nav"}),s.a.createElement(me.a.Collapse,{id:"basic-navbar-nav"},s.a.createElement(be.a,{inline:!0,onSubmit:this.handleSubmit},s.a.createElement(be.a.Group,{controlId:"courselister.accountselect",className:"navFormItem"},s.a.createElement(be.a.Label,{className:"navbar-dark navbar-text"},"Accounts:"),s.a.createElement(be.a.Control,{as:"select",name:"account",id:"account",value:this.state.accountid,onChange:this.handleAccountChange},o)),s.a.createElement(be.a.Group,{controlId:"courselister.termselect",className:"navFormItem"},s.a.createElement(be.a.Label,{className:"navbar-dark navbar-text"},"Terms:"),s.a.createElement(be.a.Control,{as:"select",name:"term",id:"term",value:this.state.termid,onChange:this.handleTermChange},l)),s.a.createElement(be.a.Group,{controlId:"courselister.keyword",className:"navFormItem"},s.a.createElement(be.a.Label,{className:"navbar-dark navbar-text"},"Search Term:"),s.a.createElement(be.a.Control,{placeholder:"(course title)",type:"text",name:"keyword",id:"keyword"})),s.a.createElement(R.a,{variant:"primary",type:"submit",className:"navFormItem"},"Submit")),s.a.createElement(me.a.Text,{className:"navFormItem"},t),s.a.createElement(me.a.Text,{id:"resultCount",className:"navFormItem"}," ",a.length?"Courses Found: "+a.length:""),s.a.createElement(me.a.Text,{id:"selectionCount",className:"navFormItem"}," ",this.state.selected.length?"  Courses Selected: "+this.state.selected.length:""," \xa0\xa0 ",this.state.selected.length?s.a.createElement("a",{href:"group/"+this.state.groupId,onClick:this.openCourseGroup,className:"btn btn-primary",target:"_new"},"Open Course Group"):""))),s.a.createElement(C.a,{fluid:!0,className:"App"},s.a.createElement(S.a,null,s.a.createElement(O.a,null,s.a.createElement(y.c,null,s.a.createElement(y.a,{exact:!0,path:"/"},s.a.createElement("div",{className:"container"},s.a.createElement(w,{courses:a,canvasHost:r,loading:n,onSelectionChanged:this.onSelectionChanged}))))))))}}]),a}(n.Component),Ce=a(379),Se=a.n(Ce),Oe=a(260);var _e=function(){function e(t){Object(l.a)(this,e),this.students=t,this.studentsNeverAccessed=[],this.studentsAccessed=[],this.meanLastAccess="N/A",this.medianLastAccess="N/A",this.createStudentLists(),this.calculateAccessStats()}return Object(i.a)(e,[{key:"createStudentLists",value:function(){var e=this;this.students.forEach((function(t){t.enrollments[0].last_activity_at?e.studentsAccessed.push(t):e.studentsNeverAccessed.push(t)}))}},{key:"calculateAccessStats",value:function(){var e=this.studentsAccessed.map((function(e,t,a){var n=new Date(e.enrollments[0].last_activity_at);return e.daysSinceActivity=function(e,t){var a=Math.abs(e-t);return Math.round(a/864e5)}(Date.now(),n),e.daysSinceActivity}));if(e&&e.length>0){this.meanLastAccess=Object(Oe.mean)(e).toFixed(1),this.medianLastAccess=Object(Oe.median)(e).toFixed(1);var t=Object(Oe.standardDeviation)(e);this.studentsAccessed.forEach((function(e,a){e.last_access_std_dev=(e.daysSinceActivity-t.toFixed(1)).toFixed(1)}))}}}]),e}(),xe=v()(),je=xe.api,Ae=(xe.getStatus,[{dataField:"id",text:"ID",formatter:function(e,t,a){return s.a.createElement("a",{href:"https://"+De+"/courses/"+t.id,target:"_blank",title:"Open in Canvas (in a new tab)"},t.id)},headerStyle:{width:"75px"}},{dataField:"name",text:"Name",headerStyle:{width:"300px"}},{dataField:"workflow_state",text:"Published",headerStyle:{width:"100px"}},{dataField:"modules-open-total",formatter:function(e,t,a){return s.a.createElement("div",null,t.modules.reduce((function(e,t){return t.published?++e:e}),0)," of ",t.modules.length," ",s.a.createElement("a",{href:"/coursetools/course/"+t.id+"/modules",target:"_blank",title:"Open CourseTools Modules (opens in a new tab)"},s.a.createElement(g.a,null)))},text:"Modules (Open/ Total)",resizeable:!0,headerStyle:{width:"80px"}},{dataField:"teachers",text:"Instructor (Last Visit)",formatter:function(e,t,a){return s.a.createElement("div",null,t.teachers.map((function(e,a){var n=e.enrollments[0].last_activity_at,r=function(e,t){var a=Math.abs(e-t);return Math.round(a/864e5)}(Date.now(),new Date(n));return s.a.createElement("div",{key:e.id},s.a.createElement("a",{href:"https://"+De+"/courses/"+t.id+"/users/"+e.id,target:"_blank",title:"Open user page in Canvas (in a new tab)"},e.name)," (",r," days) ",s.a.createElement("br",null))})))},resizeable:!0},{dataField:"total_students",text:"Number of Students",headerStyle:{width:"80px"},resizeable:!0},{dataField:"instructor_login_days",formatter:function(e,t,a){var n=new _e(t.students);return s.a.createElement("div",null,"Never Accessed: ",n.studentsNeverAccessed.length,s.a.createElement("br",null),"Avg Days Since Access: ",n.meanLastAccess,s.a.createElement("br",null),"Median Since Access: ",n.medianLastAccess,s.a.createElement("br",null))},text:"Activity Info",width:100,resizeable:!0}]),De="";var Ie=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={courseGroup:Ee.getCourseGroup(e.match.params.number),groupId:e.match.params.number,tabledata:[],data:[]},n}return Object(i.a)(a,[{key:"flattenCourseData",value:function(e){var t=e;return t.total_students=e.students&&e.students.length||"",t}},{key:"componentDidMount",value:function(){var e=Object(p.a)(h.a.mark((function e(){var t,a,n,s,r,o,l,i,c,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("did mount"),fetch("/config",{credentials:"include"}).then(function(){var e=Object(p.a)(h.a.mark((function e(t){var a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,t.json();case 3:a=e.sent,De=a.canvasHost;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),console.log(this.state.courseGroup),e.prev=3,t=0;case 5:if(!(t<this.state.courseGroup.length)){e.next=37;break}return a=this.state.courseGroup[t].id,e.next=9,je.course.get({courseId:a,includeSyllabus:!0,includeTerm:!0,includeAccount:!0,includeDescription:!0,includeSections:!0,includeCourseImage:!0,includeNeedsGradingCount:!0});case 9:return n=e.sent,console.log(n),e.next=13,je.other.endpoint({path:"/api/v1/courses/"+a+"/modules",method:"GET",params:{include:["items","content_details"]}});case 13:return s=e.sent,n.modules=s,e.next=17,je.course.assignment.list({courseId:a});case 17:return r=e.sent,o=r.map((function(e){return e.discussion_topic?e.type="Discussion":e.type="Assignment",e})),n.assignments=o,e.next=22,je.course.listStudents({courseId:a,includeEnrollments:!0});case 22:return l=e.sent,n.students=l,e.next=26,je.course.listTeachers({courseId:a,includeEnrollments:!0});case 26:i=e.sent,n.teachers=i,(c=this.state.data).push(n),this.setState({data:c}),(u=this.state.tabledata).push(this.flattenCourseData(n)),this.setState({data:c,tabledata:u});case 34:t++,e.next=5;break;case 37:e.next=42;break;case 39:return e.prev=39,e.t0=e.catch(3),e.abrupt("return",this.setState({message:"Error while retrieving course: ".concat(e.t0.message)}));case 42:case"end":return e.stop()}}),e,this,[[3,39]])})));return function(){return e.apply(this,arguments)}}()},{key:"getRowCount",value:function(){return this.state.tabledata.length}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(me.a,{bg:"dark",variant:"dark",expand:"lg"},s.a.createElement(me.a.Brand,null,"CourseGroupTools"),s.a.createElement(me.a.Toggle,{"aria-controls":"basic-navbar-nav"}),s.a.createElement(me.a.Collapse,{id:"basic-navbar-nav"},s.a.createElement(he.a,{className:"mr-auto"},s.a.createElement(he.a.Link,{href:"/coursetools/group/"+this.props.match.params.number+"/info"},"Course Group Info")),s.a.createElement(me.a.Text,null,s.a.createElement("b",null,"CourseGroup ID:")," ",this.props.match.params.number))),s.a.createElement(y.c,null,s.a.createElement(y.a,{exact:!0,path:"/group/:number"},s.a.createElement(C.a,null,s.a.createElement(S.a,null,s.a.createElement(O.a,null,s.a.createElement(Se.a,{keyField:"id",data:this.state.tabledata,columns:Ae,striped:!0,hover:!0,condensed:!0}))))),s.a.createElement(y.a,{exact:!0,path:"/group/:number/info"},"  // fix this - new component",s.a.createElement(C.a,null,s.a.createElement(S.a,null,s.a.createElement(O.a,null,s.a.createElement(Se.a,{keyField:"id",data:this.state.tabledata,columns:Ae,striped:!0,hover:!0,condensed:!0})))))))}}]),a}(n.Component),Ne=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={groupSelection:[]},n.onGroupSelectionChanged=n.onGroupSelectionChanged.bind(Object(d.a)(n)),n}return Object(i.a)(a,[{key:"onGroupSelectionChanged",value:function(e){console.log("changed in main"),console.log(e),this.setState({groupSelection:e})}},{key:"render",value:function(){return s.a.createElement("main",null,s.a.createElement(y.c,null,s.a.createElement(y.a,{exact:!0,path:"/"},s.a.createElement(ye,{groupSelectionChange:this.onGroupSelectionChanged})),s.a.createElement(y.a,{path:"/course/:number",component:ve}),s.a.createElement(y.a,{path:"/group/:number",component:Ie})))}}]),a}(n.Component),Te=(a(1426),a(1427),a(1428),a(1473),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(Ne,null))}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(E.a,{basename:"/coursetools"},s.a.createElement(Te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},520:function(e,t){},662:function(e,t,a){e.exports=a(1474)},667:function(e,t,a){},703:function(e,t){},705:function(e,t){},730:function(e,t){},732:function(e,t){},741:function(e,t){},743:function(e,t){},768:function(e,t){},770:function(e,t){},771:function(e,t){},777:function(e,t){},779:function(e,t){},797:function(e,t){},800:function(e,t){},816:function(e,t){},819:function(e,t){},841:function(e,t){}},[[662,1,2]]]);
//# sourceMappingURL=main.49fcb372.chunk.js.map